#
# Copyright (C) 2024 Intel Corporation
#
# Part of the Unified-Runtime Project, under the Apache License v2.0 with LLVM Exceptions.
# See LICENSE.TXT
# SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
#
# See YaML.md for syntax definition
#
--- #--------------------------------------------------------------------------
type: header
desc: "Intel $OneApi Unified Runtime Experimental APIs for (kernel) Launch Attributes"
ordinal: "99"
--- #--------------------------------------------------------------------------
type: macro
desc: "The extension string that defines support for the Launch Attributes extension, which is returned when querying device extensions."
name: $X_LAUNCH_ATTRIBUTES_EXTENSION_STRING_EXP
value: "\"$x_exp_launch_attributes\""
--- #--------------------------------------------------------------------------
type: enum
desc: "Specifies a launch attribute id"
name: $x_exp_launch_attribute_id_t
analogue:
    - "**CUlaunchAttributeID**"
etors:
    - name: IGNORE
      desc: "the attribute has no effect"
    - name: COOPERATIVE
      desc: "whether to launch a cooperative kernel"
    - name: CLUSTER_DIMENSION
      desc: "cluster dimensions"
--- #--------------------------------------------------------------------------
type: union
desc: "Specifies a launch attribute value"
name: $x_exp_launch_attribute_value_t
tag: $x_exp_launch_attribute_id_t
analogue:
    - "**CUlaunchAttributeValue**"
members:
    - type: uint32_t[3]
      name: clusterDim
      desc: "[in] cluster dimensions (x, y, z)"
      tag: $X_EXP_LAUNCH_ATTRIBUTE_ID_CLUSTER_DIMENSION
    - type: int
      name: cooperative
      desc: "[in] non-zero value indicates a cooperative kernel"
      tag: $X_EXP_LAUNCH_ATTRIBUTE_ID_COOPERATIVE
--- #--------------------------------------------------------------------------
type: struct
desc: "Kernel launch attribute"
name: $x_exp_launch_attribute_t
analogue:
    - "**cuLaunchAttribute**"
members:
    - type: $x_exp_launch_attribute_id_t
      name: id
      desc: "[in] Launch attribute id"
      init: $X_EXP_LAUNCH_ATTRIBUTE_ID_IGNORE
    - type: $x_exp_launch_attribute_value_t
      name: value
      desc: "[in][tagged_by(id)] Launch attribute value"
      init: nullptr
--- #--------------------------------------------------------------------------
type: function
desc: "Launch kernel with custom Launch attributes"
class: $xEnqueue
name: KernelLaunchCustomExp
ordinal: "0"
analogue:
    - "**cuLaunchKernelEx**"
details:
    - "Launches the kernel using the specified launch attributes"
    - "If numAttrsInLaunchAttrList == 0 then a regular kernel launch is used: `urEnqueueKernelLaunch`"
    - "Consult the appropriate adapter driver documentation for details of adapter specific behavior and native error codes that may be returned."
params:
    - type: $x_queue_handle_t
      name: hQueue
      desc: "[in] handle of the queue object"
    - type: $x_kernel_handle_t
      name: hKernel
      desc: "[in] handle of the kernel object"
    - type: uint32_t
      name: workDim
      desc: "[in] number of dimensions, from 1 to 3, to specify the global and work-group work-items"
    - type: const size_t*
      name: pGlobalWorkSize
      desc: "[in] pointer to an array of workDim unsigned values that specify the number of global work-items in workDim that will execute the kernel function"
    - type: const size_t*
      name: pLocalWorkSize
      desc: "[in][optional] pointer to an array of workDim unsigned values that specify the number of local work-items forming a work-group that will execute the kernel function. If nullptr, the runtime implementation will choose the work-group size."
    - type: uint32_t
      name: numAttrsInLaunchAttrList
      desc: "[in] size of the launch attr list"
    - type: $x_exp_launch_attribute_t*
      name: launchAttrList
      desc: "[in][range(0, numAttrsInLaunchAttrList)] pointer to a list of launch attributes"
    - type: uint32_t
      name: numEventsInWaitList
      desc: "[in] size of the event wait list"
    - type: const ur_event_handle_t*
      name: phEventWaitList
      desc: "[in][optional][range(0, numEventsInWaitList)] pointer to a list of events that must be complete before the kernel execution. If nullptr, the numEventsInWaitList must be 0, indicating that no wait event. "
    - type: ur_event_handle_t*
      name: phEvent
      desc: "[out][optional] return an event object that identifies this particular kernel execution instance."
returns:
    - $X_RESULT_SUCCESS
    - $X_RESULT_ERROR_UNINITIALIZED
    - $X_RESULT_ERROR_DEVICE_LOST
    - $X_RESULT_ERROR_ADAPTER_SPECIFIC
    - $X_RESULT_ERROR_INVALID_NULL_HANDLE:
        - "NULL == hQueue"
        - "NULL == hKernel"
    - $X_RESULT_ERROR_INVALID_NULL_POINTER:
        - "NULL == pGlobalWorkSize"
        - "numAttrsInLaunchAttrList != 0 && launchAttrList == NULL"
    - $X_RESULT_ERROR_INVALID_QUEUE
    - $X_RESULT_ERROR_INVALID_KERNEL
    - $X_RESULT_ERROR_INVALID_EVENT
    - $X_RESULT_ERROR_INVALID_EVENT_WAIT_LIST:
        - "phEventWaitList == NULL && numEventsInWaitList > 0"
        - "phEventWaitList != NULL && numEventsInWaitList == 0"
        - "If event objects in phEventWaitList are not valid events."
    - $X_RESULT_ERROR_IN_EVENT_LIST_EXEC_STATUS:
        - "An event in phEventWaitList has $X_EVENT_STATUS_ERROR"
    - $X_RESULT_ERROR_INVALID_WORK_DIMENSION
    - $X_RESULT_ERROR_INVALID_WORK_GROUP_SIZE
    - $X_RESULT_ERROR_INVALID_VALUE
    - $X_RESULT_ERROR_OUT_OF_HOST_MEMORY
    - $X_RESULT_ERROR_OUT_OF_RESOURCES

